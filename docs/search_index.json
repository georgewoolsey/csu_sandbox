[["scenario-analysis-wcs-priority-landscapes.html", "Section 6 Scenario Analysis: WCS Priority Landscapes 6.1 Scenarios Considered 6.2 Data Preparation 6.3 Load fireshed project area data 6.4 Landscape-level analysis 6.5 Fireshed-level analysis 6.6 High-priority project areas 6.7 Objective vs. Treatable", " Section 6 Scenario Analysis: WCS Priority Landscapes # turn off the s2 processing ## https://stackoverflow.com/questions/68478179/how-to-resolve-spherical-geometry-failures-when-joining-spatial-data sf::sf_use_s2(FALSE) See this prior section for initial Wildfire Crisis Strategy (WCS) analysis and background information. 6.1 Scenarios Considered There are three scenarios considered in this analysis of the constraints to mechanical forest health and fuel reduction treatments: # mechanical mgmt allowed if: n_sc_temp &lt;- 3 data.frame( scenario = 1:3 , cover = rep(&quot;Forest or Shrubland&quot;,n_sc_temp) , protected = rep(&quot;Not Protected&quot;,n_sc_temp) , slope = c(&quot;&lt;35%&quot;,&quot;&lt;50%&quot;,&quot;&lt;50%&quot;) , road = c(&quot;&lt;1,000ft&quot;,&quot;&lt;2,000ft&quot;,&quot;&lt;2,000ft&quot;) , riparian = c(&quot;&gt;100ft&quot;,&quot;&gt;100ft&quot;,&quot;&gt;50ft&quot;) , admin = c(&quot;No Designation&quot;,&quot;No Designation&quot;,&quot;Any Designation&quot;) ) |&gt; tidyr::pivot_longer( cols = -c(scenario) ) |&gt; tidyr::pivot_wider( names_from = scenario , values_from = value , names_prefix = &quot;scenario_&quot; ) |&gt; dplyr::mutate( name = factor( name , levels = c( &quot;cover&quot; , &quot;protected&quot; , &quot;slope&quot; , &quot;road&quot; , &quot;riparian&quot; , &quot;admin&quot; ) , labels = c( &quot;NLCD Cover Type&quot; , &quot;Protected or&lt;br&gt;IRA Status&quot; , &quot;Slope&quot; , &quot;Distance to&lt;br&gt;Nearest Road&quot; , &quot;Riparian&lt;br&gt;Buffer&quot; , &quot;Administrative&lt;br&gt;Designation&quot; ) , ordered = T ) ) |&gt; dplyr::arrange(name) |&gt; dplyr::mutate( lvl = paste0(&quot;L&quot;,dplyr::row_number()-1,&quot;:&quot;) ) |&gt; dplyr::relocate(lvl) |&gt; # make table kableExtra::kable( caption = &quot;Scenarios Considered for Determining Mechanical Treatment Operability&lt;br&gt;Mechanical treatment allowed if:&quot; , col.names = c( &quot;&quot; , &quot;&quot; , &quot;Scenario 1&lt;br&gt;Most Constrained&quot; , &quot;Scenario 2&lt;br&gt;Moderate&quot; , &quot;Scenario 3&lt;br&gt;Least Constrained&quot; ) , escape = F ) |&gt; kable_classic(full_width=T) |&gt; kableExtra::kable_styling(font_size = 11,fixed_thead = TRUE) Table 6.1: Scenarios Considered for Determining Mechanical Treatment OperabilityMechanical treatment allowed if: Scenario 1Most Constrained Scenario 2Moderate Scenario 3Least Constrained L0: NLCD Cover Type Forest or Shrubland Forest or Shrubland Forest or Shrubland L1: Protected orIRA Status Not Protected Not Protected Not Protected L2: Slope &lt;35% &lt;50% &lt;50% L3: Distance toNearest Road &lt;1,000ft &lt;2,000ft &lt;2,000ft L4: RiparianBuffer &gt;100ft &gt;100ft &gt;50ft L5: AdministrativeDesignation No Designation No Designation Any Designation 6.2 Data Preparation 6.2.1 Load landscape-level data Landscape-level constraint analysis data was created via this Google Earth Engine script; WCS priority landscape spatial data was created in this prior section. # load wcs priority landscapes wf_landscapes &lt;- sf::st_read(&quot;../data/constrained_by_wflndscp_wide_sf.gpkg&quot;) |&gt; dplyr::select(1:10) #rename sf geom column names(wf_landscapes)[names(wf_landscapes)==tolower(attr(wf_landscapes, &quot;sf_column&quot;))] = &quot;geometry&quot; sf::st_geometry(wf_landscapes) = &quot;geometry&quot; # set crs transform_crs &lt;- sf::st_crs(wf_landscapes) # load landscape constraint scenario data constrained_by_scnro_ls &lt;- list.files(&quot;../data/wildfirepriority/all_rd/&quot;,pattern = &quot;\\\\.csv$&quot;) %&gt;% purrr::keep(stringr::str_starts(.,&quot;wfpriority_all_rd_sc&quot;)) %&gt;% purrr::map(function(x){ readr::read_csv( paste0(&quot;../data/wildfirepriority/all_rd/&quot;,x) , name_repair = &quot;universal&quot; , col_types = cols(.default = &quot;c&quot;) ) %&gt;% dplyr::rename_with(tolower) %&gt;% dplyr::rename_with(make.names) %&gt;% dplyr::select(state,name,tidyselect::ends_with(&quot;_m2&quot;),tidyselect::starts_with(&quot;pct_&quot;)) %&gt;% dplyr::mutate(scenario_id = stringr::word(x,4,sep=&quot;_&quot;) %&gt;% readr::parse_number()) %&gt;% dplyr::relocate(scenario_id) }) %&gt;% dplyr::bind_rows() %&gt;% dplyr::inner_join( wf_landscapes %&gt;% sf::st_drop_geometry() %&gt;% dplyr::select(state,name,area_name) , by = dplyr::join_by(state,name) ) %&gt;% dplyr::relocate(area_name,.after = &quot;scenario_id&quot;) %&gt;% dplyr::group_by(area_name,scenario_id) %&gt;% dplyr::filter(dplyr::row_number()==1) %&gt;% dplyr::ungroup() %&gt;% dplyr::mutate( dplyr::across( tidyselect::ends_with(&quot;_m2&quot;) , ~ as.numeric(.x) / 10000 ) , dplyr::across( tidyselect::starts_with(&quot;pct_&quot;) , ~ as.numeric(.x) ) ) %&gt;% dplyr::rename_with( ~ gsub(&quot;_m2&quot;, &quot;_ha&quot;, .x) , tidyselect::ends_with(&quot;_m2&quot;) ) %&gt;% # calculate pct reduction dplyr::mutate( pct_rdctn1_protected = -1*(1 - pct_rmn1_protected) , pct_rdctn2_slope = -1*(pct_rmn1_protected - pct_rmn2_slope) , pct_rdctn3_roads = -1*(pct_rmn2_slope - pct_rmn3_roads) , pct_rdctn4_riparian = -1*(pct_rmn3_roads - pct_rmn4_riparian) , pct_rdctn5_administrative = -1*(pct_rmn4_riparian - pct_rmn5_administrative) , pct_rdctn_total = -1*(1 - pct_rmn5_administrative) , pct_covertype_area = covertype_area_ha/feature_area_ha # scenario description , scenario_lab = factor( scenario_id , levels = 1:3 , labels = paste0(&quot;Scenario &quot;, 1:3) , ordered = T ) |&gt; forcats::fct_rev() , scenario_desc = factor( scenario_id , levels = 1:3 , labels = c(&quot;Scenario 1\\n(status quo)&quot;, &quot;Scenario 2\\n(slopes+roads)&quot;, &quot;Scenario 3\\n(slopes+roads+admin)&quot;) , ordered = T ) ) 6.3 Load fireshed project area data Data created via this Google Earth Engine script See this section for exploration of fireshed and project area spatial data # load firesheds fireshed &lt;- sf::st_read(&quot;../data/firesheds/fireshed.gpkg&quot;) |&gt; sf::st_transform(transform_crs) |&gt; dplyr::mutate( crisis_strategy = ifelse(is.na(crisis_strategy),&quot;No WCS Status&quot;,crisis_strategy) |&gt; as.factor() |&gt; forcats::fct_shift() ) #rename sf geom column names(fireshed)[names(fireshed)==tolower(attr(fireshed, &quot;sf_column&quot;))] = &quot;geometry&quot; sf::st_geometry(fireshed) = &quot;geometry&quot; # load fireshed project areas fireshed_proj_area &lt;- sf::st_read(&quot;../data/firesheds/fireshed_proj_area.gpkg&quot;) |&gt; sf::st_transform(transform_crs) |&gt; dplyr::mutate( fireshed_crisis_strategy = ifelse(is.na(fireshed_crisis_strategy),&quot;No WCS Status&quot;,fireshed_crisis_strategy) |&gt; as.factor() |&gt; forcats::fct_shift() ) #rename sf geom column names(fireshed_proj_area)[names(fireshed_proj_area)==tolower(attr(fireshed_proj_area, &quot;sf_column&quot;))] = &quot;geometry&quot; sf::st_geometry(fireshed_proj_area) = &quot;geometry&quot; # load fireshed constraint scenario data constrained_by_scnro_ls_pa &lt;- list.files(&quot;../data/wildfirepriority/fireshed_rd/&quot;,pattern = &quot;\\\\.csv$&quot;) %&gt;% purrr::keep(stringr::str_starts(.,&quot;wfpriority_fireshed_rd_sc&quot;)) %&gt;% purrr::map(function(x){ readr::read_csv( paste0(&quot;../data/wildfirepriority/fireshed_rd/&quot;,x) , name_repair = &quot;universal&quot; , col_types = cols(.default = &quot;c&quot;) ) %&gt;% dplyr::rename_with(tolower) %&gt;% dplyr::rename_with(make.names) %&gt;% dplyr::select(state,name,pa_id,tidyselect::ends_with(&quot;_m2&quot;),tidyselect::starts_with(&quot;pct_&quot;)) %&gt;% dplyr::mutate(scenario_id = stringr::word(x,4,sep=&quot;_&quot;) %&gt;% readr::parse_number()) %&gt;% dplyr::relocate(scenario_id) }) %&gt;% dplyr::bind_rows() %&gt;% dplyr::inner_join( wf_landscapes %&gt;% sf::st_drop_geometry() %&gt;% dplyr::select(state,name,area_name) , by = dplyr::join_by(state,name) ) %&gt;% dplyr::relocate(area_name,.after = &quot;scenario_id&quot;) %&gt;% dplyr::mutate( dplyr::across( tidyselect::ends_with(&quot;_m2&quot;) , ~ as.numeric(.x) / 10000 ) , dplyr::across( tidyselect::starts_with(&quot;pct_&quot;) , ~ as.numeric(.x) ) ) %&gt;% dplyr::rename_with( ~ gsub(&quot;_m2&quot;, &quot;_ha&quot;, .x) , tidyselect::ends_with(&quot;_m2&quot;) ) %&gt;% dplyr::group_by(area_name,pa_id,scenario_id) %&gt;% dplyr::arrange(desc(pct_pa_intrsct)) %&gt;% dplyr::filter(dplyr::row_number()==1) %&gt;% dplyr::ungroup() %&gt;% dplyr::filter(pct_pa_intrsct&gt;=0.25) %&gt;% # calculate pct reduction dplyr::mutate( pct_rdctn1_protected = -1*(1 - pct_rmn1_protected) , pct_rdctn2_slope = -1*(pct_rmn1_protected - pct_rmn2_slope) , pct_rdctn3_roads = -1*(pct_rmn2_slope - pct_rmn3_roads) , pct_rdctn4_riparian = -1*(pct_rmn3_roads - pct_rmn4_riparian) , pct_rdctn5_administrative = -1*(pct_rmn4_riparian - pct_rmn5_administrative) , pct_rdctn_total = -1*(1 - pct_rmn5_administrative) , pct_covertype_area = covertype_area_ha/feature_area_ha # calculate level of constraint , cnstrnt_lvl = dplyr::case_when( -pct_rdctn_total &gt;= 0.85 ~ 1 , -pct_rdctn_total &gt;= 0.65 ~ 2 , -pct_rdctn_total &gt;= 0.0 ~ 3 ) , cnstrnt_class = factor( cnstrnt_lvl , levels = 1:3 , labels = c(&quot;high constraint&quot;, &quot;med. constraint&quot;, &quot;low constraint&quot;) , ordered = T ) %&gt;% forcats::fct_rev() , rmn_cnstrnt_class = factor( cnstrnt_lvl , levels = 1:3 , labels = c(&quot;0–15% treatable&quot;, &quot;16–35% treatable&quot;, &quot;&gt;35% treatable&quot;) , ordered = T ) %&gt;% forcats::fct_rev() # scenario description , scenario_lab = factor( scenario_id , levels = 1:3 , labels = paste0(&quot;Scenario &quot;, 1:3) , ordered = T ) |&gt; forcats::fct_rev() , scenario_desc = factor( scenario_id , levels = 1:3 , labels = c(&quot;Scenario 1\\n(status quo)&quot;, &quot;Scenario 2\\n(slopes+roads)&quot;, &quot;Scenario 3\\n(slopes+roads+admin)&quot;) , ordered = T ) ) %&gt;% # join with fireshed data dplyr::inner_join( fireshed_proj_area %&gt;% sf::st_drop_geometry() %&gt;% dplyr::select(pa_id, tidyselect::starts_with(&quot;pa_exposure&quot;), tidyselect::starts_with(&quot;fireshed_&quot;)) %&gt;% dplyr::mutate(pa_id=as.character(pa_id)) , by = dplyr::join_by(pa_id) ) 6.4 Landscape-level analysis 6.4.1 Reduction Treatable Area Table scnum_temp&lt;-2 tbl_temp &lt;- constrained_by_scnro_ls |&gt; dplyr::filter(scenario_id==scnum_temp) |&gt; dplyr::mutate( dplyr::across( tidyselect::ends_with(&quot;_ha&quot;) , ~ scales::comma(.x, accuracy = 1) ) , dplyr::across( tidyselect::starts_with(&quot;pct_&quot;) , ~ scales::percent(.x, accuracy = 0.1) ) ) |&gt; dplyr::select( state , name , covertype_area_ha , pct_covertype_area , pct_rdctn1_protected , pct_rdctn2_slope , pct_rdctn3_roads , pct_rdctn4_riparian , pct_rdctn5_administrative , rmn5_administrative_area_ha , pct_rmn5_administrative ) |&gt; dplyr::arrange(state,name) # make table kableExtra::kable( tbl_temp |&gt; dplyr::select(-c(state)) , caption = paste0(&quot;&lt;b&gt;&lt;font color=navy&gt;Scenario &quot;,scnum_temp,&quot;&lt;/font&gt;&lt;/b&gt;&lt;br&gt;percent reduction of different types of constraints on mechanical treatment&quot;) , col.names = c( &quot;&quot; , &quot;Forest+Shrub\\n(ha)&quot;, &quot;Forest+Shrub\\n%&quot; , &quot;Protected&quot; , &quot;Slope\\nSteepness&quot; , &quot;Road\\nDistance&quot; , &quot;Riparian\\nBuffer&quot; , &quot;Administrative&quot; , &quot;Remaining (ha)&quot; , &quot;Remaining (%)&quot; ) , escape = F ) |&gt; add_header_above(c(&quot; &quot; = 1, &quot;Area of\\nPriority Landscape&quot;=2, &quot;Constraint\\nLeast Flexible to Most Flexible&quot; = 5, &quot; &quot; = 2)) |&gt; kable_classic(full_width=T) |&gt; pack_rows(index = table(forcats::fct_inorder(tbl_temp$state))) |&gt; kableExtra::kable_styling(font_size = 11,fixed_thead = TRUE) |&gt; kableExtra::scroll_box(width = &quot;740px&quot;) Table 6.2: Scenario 2percent reduction of different types of constraints on mechanical treatment Area ofPriority Landscape ConstraintLeast Flexible to Most Flexible Forest+Shrub (ha) Forest+Shrub % Protected Slope Steepness Road Distance Riparian Buffer Administrative Remaining (ha) Remaining (%) Arizona 4FRI 2,190,804 90.6% -13.8% -4.1% -12.4% -13.5% -19.1% 811,975 37.1% Prescott 219,110 86.4% -12.1% -7.9% -11.1% -17.8% -7.6% 95,155 43.4% San Carlos Apache Tribal Forest Protection 1,056,065 91.4% -6.1% -11.0% -44.9% -9.8% -1.4% 282,658 26.8% California North Yuba 139,202 96.5% -11.6% -22.6% -2.3% -20.3% -3.0% 55,989 40.2% Plumas Community Protection 100,872 93.3% 0.0% -11.4% -7.0% -31.5% -2.7% 47,658 47.2% Southern California Fireshed Risk Reduction Strategy 1,408,168 86.0% -57.0% -14.8% -5.2% -3.7% -2.5% 236,325 16.8% Stanislaus 116,139 94.3% -2.9% -16.7% -3.0% -33.0% -0.8% 50,559 43.5% Trinity Forest Health and Fire-Resilient Rural Communities 295,916 80.4% -12.9% -23.4% -4.9% -17.6% -19.8% 63,217 21.4% Colorado Colorado Front Range 1,051,540 72.6% -20.4% -11.1% -10.5% -16.3% -2.8% 408,302 38.8% Idaho Nez Perce-Clearwater-Lower Salmon 699,884 89.0% -43.0% -11.8% -4.6% -2.0% -0.6% 266,295 38.0% Southwest Idaho 608,338 87.6% -13.3% -15.3% -5.4% -2.6% -0.7% 381,579 62.7% Montana Kootenai Complex 372,345 91.4% -21.4% -7.8% -1.7% -8.2% -13.3% 177,160 47.6% Nevada Sierra and Elko Fronts 1,003,525 73.2% -26.6% -4.8% -14.8% -8.6% -1.4% 439,369 43.8% New Mexico Enchanted Circle 506,460 85.6% -8.5% -11.6% -22.9% -11.0% -3.4% 215,496 42.5% Oregon Central Oregon 937,977 88.8% -7.2% -1.2% -4.7% -5.9% -11.4% 652,634 69.6% Klamath River Basin 2,900,530 77.7% -20.5% -10.5% -7.2% -7.8% -7.0% 1,362,076 47.0% Mount Hood Forest Health and Fire-Resilient Communities 334,397 76.7% -19.6% -8.1% -6.8% -12.5% -20.1% 110,395 33.0% Utah Pine Valley 153,246 94.2% -37.2% -3.4% -9.7% -9.0% 0.0% 62,385 40.7% Wasatch 381,429 89.5% -43.0% -7.1% -6.9% -6.5% -0.4% 137,670 36.1% Washington Central Washington Initiative 670,440 68.1% -20.6% -19.8% -6.4% -12.5% -18.5% 148,732 22.2% Colville Northeast Washington Vision 655,989 92.8% -20.1% -8.9% -6.7% -13.6% -1.9% 320,175 48.8% 6.4.2 Change in Available by Scenario ggplot( data = constrained_by_scnro_ls , mapping = aes(x=scenario_desc,y=pct_rmn5_administrative,group=area_name) ) + geom_line(mapping=aes(color = area_name), linewidth = 1.5) + geom_label( mapping=aes(label = scales::percent(pct_rmn5_administrative, scale = 100, accuracy = 1)) , color = &quot;black&quot; , size = 3 , label.padding = unit(0.15, &quot;lines&quot;) ) + facet_wrap(facets = vars(area_name) , ncol = 3 , labeller = label_wrap_gen(width = 35, multi_line = TRUE) , scales = &quot;free_x&quot; ) + scale_color_viridis_d(option = &quot;turbo&quot;, alpha = 0.8) + scale_y_continuous(expand = expansion(mult = c(0.1, 0.1)), labels = scales::percent_format(), breaks = scales::extended_breaks(6)) + # scale_x_discrete(labels = scales::label_wrap(20)) + labs( x = &quot;Most Restrictive \\U2192 Least Restrictive&quot; , y = &quot;Percent Treatable Area Remaining&quot; ) + theme_light() + theme( legend.position = &quot;none&quot; , axis.text.y = element_text(size=7) , axis.text.x = element_text(size=7.5) ) 6.4.3 Reduction by Constraint # reshape constrained_by_scnro_ls_long &lt;- constrained_by_scnro_ls |&gt; dplyr::select(state, name, area_name, tidyselect::starts_with(&quot;scenario_&quot;), tidyselect::starts_with(&quot;pct_rdctn&quot;)) |&gt; tidyr::pivot_longer( cols = tidyselect::starts_with(&quot;pct_rdctn&quot;) , names_to = &quot;constraint&quot; , values_to = &quot;pct_rdctn&quot; , names_prefix = &quot;pct_rdctn&quot; , values_drop_na = F ) |&gt; tidyr::separate_wider_delim(constraint, &quot;_&quot;, names = c(&quot;constraint_lvl&quot;, &quot;constraint&quot;)) |&gt; dplyr::mutate( constraint_lvl = as.numeric(constraint_lvl) , constraint = factor( constraint , ordered = TRUE , levels = c( &quot;protected&quot; , &quot;slope&quot; , &quot;roads&quot; , &quot;riparian&quot; , &quot;administrative&quot; , &quot;total&quot; ) , labels = c( &quot;Protected&quot; , &quot;Slope\\nSteepness&quot; , &quot;Road\\nDistance&quot; , &quot;Riparian\\nBuffer&quot; , &quot;Administrative&quot; , &quot;Total&quot; ) ) |&gt; forcats::fct_rev() ) |&gt; dplyr::left_join( constrained_by_scnro_ls |&gt; dplyr::select(state,name,scenario_id,pct_rdctn_total) , by = join_by(state,name,scenario_id) ) # plot ggplot() + geom_col( data = constrained_by_scnro_ls_long |&gt; dplyr::filter(constraint!=&quot;Total&quot;) , mapping = aes(y = scenario_lab, x = pct_rdctn, fill = constraint) , color = NA, width = 0.7 ) + geom_text( data = constrained_by_scnro_ls_long |&gt; dplyr::filter(constraint!=&quot;Total&quot;) , mapping = aes( y = scenario_lab, x = pct_rdctn , label = scales::percent(ifelse(pct_rdctn&lt;.06*-1,pct_rdctn,NA), accuracy = 1) , fontface = &quot;bold&quot; ) , position = position_stack(vjust = 0.5) , color = &quot;black&quot;, size = 3 ) + geom_text( data = constrained_by_scnro_ls_long |&gt; dplyr::filter(constraint==&quot;Total&quot;) , mapping = aes( y = scenario_lab, x = pct_rdctn_total , label = scales::percent(pct_rdctn_total, accuracy = 1) ) , color = &quot;black&quot;, size = 3.5 , hjust = -0.1 ) + facet_wrap(facets = vars(area_name) , ncol = 3 , labeller = label_wrap_gen(width = 35, multi_line = TRUE) ) + scale_fill_viridis_d(option = &quot;plasma&quot;, alpha = 0.7) + scale_x_reverse(expand = expansion(mult = c(0, .12)),labels = scales::percent_format()) + labs( fill = &quot;&quot; , y = &quot;&quot; , x = &quot;Constraint Reduction in Treatable Area (%)&quot; ) + theme_light() + theme( legend.position = &quot;top&quot; , legend.direction = &quot;horizontal&quot; , legend.title = element_text(size=7) , axis.title = element_text(size=9) , axis.text.x = element_blank() ) 6.5 Fireshed-level analysis Based on model simulations of how much area generally needs to be treated to influence wildfire behavior, we binned the firesheds into three classes of mechanical constraint: high (85–100% [i.e., only 0–15% is available for mechanical treatment]): fuels treatment would principally need to rely on fire medium (65– 84%): could use a combination of fire and mechanical thinning low (65%): could effectively influence wildfire behavior with mechanical treatment alone 6.5.1 Distribution of Fireshed Constraint constrained_by_scnro_ls_pa |&gt; dplyr::count(area_name,scenario_desc,cnstrnt_class) |&gt; dplyr::group_by(area_name,scenario_desc) |&gt; dplyr::mutate( pct = n/sum(n) , high_pct=max(ifelse(cnstrnt_class==&quot;high constraint&quot;,pct,0)) , tot = sum(n) ) |&gt; ggplot() + geom_col( mapping = aes(x = pct, y = reorder(area_name, desc(area_name)), fill=cnstrnt_class) ,width = 0.7, alpha=0.8 ) + geom_text( mapping = aes(x = pct, y = reorder(area_name, desc(area_name)), group=cnstrnt_class ,label = scales::percent(ifelse(pct&gt;=0.05,pct,NA), accuracy = 1) ) , position = position_stack(vjust = 0.5) , color = &quot;black&quot;, size = 3 ) + # geom_text( # data = constrained_byftr_huc12_wide |&gt; # dplyr::group_by(area_name) |&gt; # dplyr::summarise(n=n(), high_n=sum(ifelse(cnstrnt_class==&quot;high constraint&quot;,1,0))) # , mapping = aes(x = -0.05,y=reorder(area_name, -(high_n/n)),label=paste0(&quot;n=&quot;,scales::comma(n))) # , size = 3 # , color = &quot;black&quot; # , hjust = 0.7 # ) + scale_fill_brewer(type = &quot;div&quot;, palette = &quot;RdYlBu&quot;, direction = -1) + facet_grid(cols = vars(scenario_desc)) + scale_x_continuous(labels = scales::percent_format()) + labs( fill = &quot;Level of\\nConstraint&quot; , y = &quot;&quot; , x = &quot;% of Fireshed\\nProject Areas&quot; ) + theme_light() + theme( legend.position = &quot;top&quot; , legend.title = element_text(size=7) , axis.title = element_text(size=9) , axis.text.x = element_text(size=7) , strip.text = element_text(color = &quot;black&quot;, face = &quot;bold&quot;) ) 6.5.2 Distribution of Fireshed Area # plot ggplot(data = constrained_by_scnro_ls_pa |&gt; dplyr::filter(scenario_id==1) , mapping = aes(x = feature_area_ha, y = reorder(area_name,desc(area_name) )) ) + geom_vline( xintercept = constrained_by_scnro_ls_pa |&gt; dplyr::filter(scenario_id==1) |&gt; dplyr::pull(feature_area_ha) |&gt; median() , linetype=&quot;dashed&quot;, color=&quot;gray66&quot; ) + geom_violin(aes(fill = state)) + geom_boxplot(width = 0.15) + # geom_point(size = 0.7, color = &quot;gray33&quot;, alpha = 0.2) + geom_text( data = constrained_by_scnro_ls_pa |&gt; dplyr::filter(scenario_id==1) |&gt; dplyr::group_by(area_name) |&gt; dplyr::summarise(n=n(), max_area=max(feature_area_ha)) , mapping = aes( x = ( constrained_by_scnro_ls_pa |&gt; dplyr::filter(scenario_id==1) |&gt; dplyr::pull(feature_area_ha) |&gt; min() )*.9 ,y=reorder(area_name,desc(area_name) ) ,label=paste0(&quot;n=&quot;,scales::comma(n)) ) , size = 3 , color = &quot;black&quot; , hjust = 0.7 ) + scale_fill_viridis_d(option = &quot;viridis&quot;, alpha = 0.8) + scale_x_continuous(labels = scales::comma, breaks = scales::extended_breaks(n=7)) + labs( fill = &quot;&quot; , y = &quot;&quot; , x = &quot;Fireshed Area (ha)&quot; ) + theme_light() + theme( legend.position = &quot;none&quot; # c(0.9, 0.9) , axis.title = element_text(size=9) , axis.text.x = element_text(size=7) ) 6.5.3 Map of Firesheds by Level of Constraint # polish for mapping map_fs_temp &lt;- fireshed_proj_area |&gt; dplyr::select(pa_id, geometry) |&gt; dplyr::mutate(pa_id=as.character(pa_id)) |&gt; dplyr::inner_join( constrained_by_scnro_ls_pa , by = dplyr::join_by(&quot;pa_id&quot;) , multiple = &quot;all&quot; ) |&gt; dplyr::mutate( dplyr::across( tidyselect::starts_with(&quot;pct_&quot;) , ~ scales::percent(as.numeric(.x), accuracy = 0.1) ) , dplyr::across( tidyselect::ends_with(&quot;_ha&quot;) , ~ scales::comma(as.numeric(.x), accuracy = 1) ) ) |&gt; dplyr::mutate( Priority.Area.Name = area_name , Level.of.Constraint = cnstrnt_class , Pct.Treatable.Class = rmn_cnstrnt_class , Fireshed.ProjArea.ID = pa_id , Fireshed.ProjArea.Area.Hectares = feature_area_ha , Fireshed.WCS.Status = ifelse(is.na(fireshed_crisis_strategy),&quot;No WCS Status&quot;,fireshed_crisis_strategy) , ForestShrub.Area.Hectares = covertype_area_ha , Pct.Rdctn.Protected = pct_rdctn1_protected , Pct.Rdctn.Slope = pct_rdctn2_slope , Pct.Rdctn.Roads = pct_rdctn3_roads , Pct.Rdctn.Riparian = pct_rdctn4_riparian , Pct.Rdctn.Administrative = pct_rdctn5_administrative , Treatable.Area.Hectares = rmn5_administrative_area_ha , Pct.Treatable.Area = pct_rmn5_administrative ) # filter for mapview mapview_fs_temp &lt;- map_fs_temp |&gt; dplyr::filter( scenario_id == 2 ) # ## filter for high priority only # hi_map_fs_temp &lt;- map_fs_temp |&gt; # dplyr::filter(!is.na(fireshed_crisis_strategy)) # mapview mapview::mapviewOptions(homebutton = FALSE, basemaps = c(&quot;OpenStreetMap&quot;,&quot;Esri.WorldImagery&quot;)) mapview::mapview(wf_landscapes , color = &quot;black&quot; , lwd = 1 , alpha.regions = 0 , label = FALSE , legend = FALSE , popup = FALSE , layer.name = &quot;WCS Landscapes&quot; , hide = TRUE ) + mapview::mapview( mapview_fs_temp , zcol = &quot;cnstrnt_class&quot; , col.regions = RColorBrewer::brewer.pal(n=3,name=&quot;RdYlBu&quot;) |&gt; rev() , alpha.regions = 0.6 , lwd = 0.2 , label = FALSE , legend = FALSE , layer.name = &quot;Fireshed Constraints&quot; , popup = leafpop::popupTable( mapview_fs_temp , zcol = c( &quot;Priority.Area.Name&quot; , &quot;Level.of.Constraint&quot; , &quot;Pct.Treatable.Class&quot; , &quot;Fireshed.ProjArea.ID&quot; , &quot;Fireshed.ProjArea.Area.Hectares&quot; , &quot;Fireshed.WCS.Status&quot; , &quot;ForestShrub.Area.Hectares&quot; , &quot;Pct.Rdctn.Protected&quot; , &quot;Pct.Rdctn.Slope&quot; , &quot;Pct.Rdctn.Roads&quot; , &quot;Pct.Rdctn.Riparian&quot; , &quot;Pct.Rdctn.Administrative&quot; , &quot;Treatable.Area.Hectares&quot; , &quot;Pct.Treatable.Area&quot; ) , row.numbers = FALSE , feature.id = FALSE ) ) Scenario 2 used for map above 6.5.4 Map of High Priority Fireshed Project Areas plt_fn_temp &lt;- function(scnum=1) { ggplot() + geom_sf(data = map_fs_temp |&gt; dplyr::filter(scenario_id==scnum &amp; !is.na(fireshed_crisis_strategy)) , aes(fill = cnstrnt_class), lwd = 0.05) + geom_sf( data = USAboundaries::us_states(states = c( # usfs region 1-6 states &quot;MT&quot;,&quot;WY&quot;,&quot;CO&quot;,&quot;NM&quot;,&quot;AZ&quot;,&quot;UT&quot;,&quot;ID&quot;,&quot;WA&quot;,&quot;OR&quot;,&quot;CA&quot;,&quot;NV&quot; # , &quot;KS&quot;,&quot;NE&quot;,&quot;SD&quot;,&quot;ND&quot; )) |&gt; sf::st_transform(sf::st_crs(map_fs_temp)) , fill = NA , color = &quot;gray55&quot; ) + geom_sf(data = wf_landscapes, fill = NA, color = &quot;gray22&quot;, lwd = 0.2) + ggrepel::geom_text_repel(data = wf_landscapes , aes(label = stringr::str_wrap( dplyr::case_when( stringr::str_count(name, &quot;\\\\w+&quot;)&lt;2 ~ stringr::word(name,1,stringr::str_count(name, &quot;\\\\w+&quot;)) , stringr::str_starts(name,&quot;Sierra and Elko&quot;) ~ stringr::word(name,1,3) , TRUE ~ stringr::word(name,1,2) ) , 7) , geometry = geometry ) , stat = &quot;sf_coordinates&quot; , size = 2 , seed = 11 # , min.segment.length = 0 ) + scale_fill_brewer(type = &quot;div&quot;, palette = &quot;RdYlBu&quot;, direction = -1) + scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) + labs( fill = &quot;&quot; , x = &quot;&quot; , y =&quot;&quot; , subtitle = map_fs_temp |&gt; dplyr::filter(scenario_id==scnum) |&gt; dplyr::pull(scenario_desc) |&gt; unique() ) + theme_light() + theme( legend.position = c(0.9,0.9) # &quot;top&quot; , legend.text = element_text(size = 7) , axis.text = element_text(size=7) ) } # plot map_fs_temp |&gt; dplyr::pull(scenario_id) |&gt; unique() |&gt; purrr::map(plt_fn_temp) Only fireshed project areas with a high priority WCS Status shown above. Some fireshed project areas are within the bounds of the priority landscapes but are not within a “high priority” fireshed. 6.6 High-priority project areas Models suggest that fuels reduction treatments can effectively reduce fire size and severity when 20-40% of the landscape has been treated (e.g., Finney, 2007) and the plan (USFS, 2022a) aims to treat this amount of high-risk fireshed area within the 21 priority landscapes. The total area of the 21 priority landscapes is approximately 47 million acres (19 million ha), of which 23.7 million acres (9.6 million ha) are in high-risk firesheds; an objective of treating 20-40% would indicate the need to treat between 4.7 to 9.5 million acres (1.9 to 3.8 million ha). 6.6.1 Project Areas by WCS Status # aggregate data by area, status wcs_status_temp &lt;- constrained_by_scnro_ls_pa |&gt; dplyr::filter(scenario_id==1) |&gt; dplyr::group_by(area_name,fireshed_crisis_strategy) |&gt; dplyr::summarise( n = n() , feature_area_ha = sum(feature_area_ha) ) |&gt; dplyr::group_by(area_name) |&gt; dplyr::mutate( tot_n = sum(n) , tot_area = sum(feature_area_ha) , pct_n = n/tot_n , pct_area = feature_area_ha/tot_area ) |&gt; dplyr::ungroup() # plot ggplot(data = wcs_status_temp) + geom_col( mapping = aes(y = reorder(area_name,tot_n), x = n, fill = fireshed_crisis_strategy) , color = NA, width = 0.7 ) + geom_text( mapping = aes( y = area_name, x = n, group = fireshed_crisis_strategy , label = scales::comma(ifelse(n&gt;20,n,NA), accuracy = 1) , fontface = &quot;bold&quot; ) , position = position_stack(vjust = 0.5) , color = &quot;black&quot;, size = 3 ) + geom_text( data = constrained_by_scnro_ls_pa |&gt; dplyr::filter(scenario_id==1) |&gt; dplyr::group_by(area_name) |&gt; dplyr::summarise( n = n() , feature_area_ha = sum(feature_area_ha) ) , mapping = aes( y = reorder(area_name,n), x = n , label = scales::comma(n, accuracy = 1) ) , color = &quot;black&quot;, size = 3.5 , hjust = -0.1 ) + scale_fill_manual(values = c(&quot;All-Lands&quot;=&quot;firebrick&quot;,&quot;USFS-Only&quot;=&quot;orange3&quot;,&quot;No WCS Status&quot;=&quot;gray&quot;)) + scale_x_continuous(expand = expansion(mult = c(0, 0.1)),labels = scales::comma_format()) + labs( fill = &quot;High-Risk\\nStatus&quot; , y = &quot;&quot; , x = &quot;# of Fireshed\\nProject Areas&quot; ) + theme_light() + theme( legend.position = &quot;top&quot; , legend.title = element_text(size=7) , axis.title = element_text(size=9) , axis.text.x = element_text(size=7) , strip.text = element_text(color = &quot;black&quot;, face = &quot;bold&quot;) ) 6.6.2 Map of high-risk project areas Only including fireshed planning areas that have at least 25% of their area within the bounds of the priority landscapes and are in a high-risk fireshed. ggplot() + geom_sf(data = fireshed_proj_area |&gt; dplyr::filter(fireshed_crisis_strategy %in% c(&quot;USFS-Only&quot;, &quot;All-Lands&quot;)) |&gt; dplyr::mutate(pa_id=as.character(pa_id)) |&gt; dplyr::inner_join( constrained_by_scnro_ls_pa |&gt; dplyr::select(pa_id) , by = dplyr::join_by(pa_id) ) , aes(fill = fireshed_crisis_strategy), lwd = 0.05 ) + geom_sf( data = USAboundaries::us_states(states = c( # usfs region 1-6 states &quot;MT&quot;,&quot;WY&quot;,&quot;CO&quot;,&quot;NM&quot;,&quot;AZ&quot;,&quot;UT&quot;,&quot;ID&quot;,&quot;WA&quot;,&quot;OR&quot;,&quot;CA&quot;,&quot;NV&quot; # , &quot;KS&quot;,&quot;NE&quot;,&quot;SD&quot;,&quot;ND&quot; )) |&gt; sf::st_transform(transform_crs) , fill = NA , color = &quot;gray55&quot; ) + geom_sf(data = wf_landscapes, fill = NA, color = &quot;gray22&quot;, lwd = 0.2) + ggrepel::geom_text_repel(data = wf_landscapes , aes(label = stringr::str_wrap( dplyr::case_when( stringr::str_count(name, &quot;\\\\w+&quot;)&lt;2 ~ stringr::word(name,1,stringr::str_count(name, &quot;\\\\w+&quot;)) , stringr::str_starts(name,&quot;Sierra and Elko&quot;) ~ stringr::word(name,1,3) , TRUE ~ stringr::word(name,1,2) ) , 7) , geometry = geometry ) , stat = &quot;sf_coordinates&quot; , size = 2 , seed = 11 # , min.segment.length = 0 ) + scale_fill_manual(values = c(&quot;All-Lands&quot;=&quot;firebrick&quot;,&quot;USFS-Only&quot;=&quot;orange3&quot;)) + scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0)) + labs( fill = &quot;&quot; , x = &quot;&quot; , y =&quot;&quot; ) + theme_light() + theme( legend.position = c(0.9,0.9) # &quot;top&quot; , legend.text = element_text(size = 7) , axis.text = element_text(size=7) ) 6.6.3 Area of high-risk project areas # data filter wcs_status_temp |&gt; dplyr::filter(fireshed_crisis_strategy!=&quot;No WCS Status&quot;) |&gt; dplyr::group_by(area_name) |&gt; dplyr::mutate(tot_area = sum(feature_area_ha)) |&gt; # plot ggplot() + geom_col( mapping = aes(y = reorder(area_name,tot_area), x = feature_area_ha, fill = fireshed_crisis_strategy) , color = NA, width = 0.7 ) + geom_text( mapping = aes( y = area_name, x = feature_area_ha, group = fireshed_crisis_strategy , label = ifelse( feature_area_ha&lt;150000 ,NA ,scales::comma(feature_area_ha,suffix = &quot;k&quot;, scale = 1e-3, accuracy = 1) ) , fontface = &quot;bold&quot; ) , position = position_stack(vjust = 0.5) , color = &quot;black&quot;, size = 3 ) + geom_text( data = constrained_by_scnro_ls_pa |&gt; dplyr::filter( scenario_id==1 &amp; fireshed_crisis_strategy!=&quot;No WCS Status&quot; ) |&gt; dplyr::group_by(area_name) |&gt; dplyr::summarise( n = n() , feature_area_ha = sum(feature_area_ha) ) , mapping = aes( y = reorder(area_name,feature_area_ha), x = feature_area_ha , label = scales::comma(feature_area_ha,suffix = &quot;k ha&quot;, scale = 1e-3, accuracy = 1) ) , color = &quot;black&quot;, size = 3.5 , hjust = -0.1 ) + scale_fill_manual(values = c(&quot;All-Lands&quot;=&quot;firebrick&quot;,&quot;USFS-Only&quot;=&quot;orange3&quot;,&quot;No WCS Status&quot;=&quot;gray&quot;)) + scale_x_continuous(expand = expansion(mult = c(0, 0.15)),labels = scales::comma_format(suffix = &quot;k ha&quot;, scale = 1e-3, accuracy = 1)) + labs( fill = &quot;High-Risk\\nStatus&quot; , y = &quot;&quot; , x = &quot;Area (ha) of Fireshed\\nProject Areas&quot; ) + theme_light() + theme( legend.position = &quot;top&quot; , legend.title = element_text(size=7) , axis.title = element_text(size=9) , axis.text.x = element_text(size=7) , strip.text = element_text(color = &quot;black&quot;, face = &quot;bold&quot;) ) 6.7 Objective vs. Treatable Models suggest that fuels reduction treatments can effectively reduce fire size and severity when 20-40% of the landscape has been treated (e.g., Finney, 2007) and the Strategy (USFS, 2022a) aims to treat this amount of high-risk fireshed area within the 21 priority landscapes. The total area of the 21 priority landscapes is approximately 47 million acres (19 million ha), of which 23.7 million acres (9.6 million ha) are in high-risk firesheds; an objective of treating 20-40% would indicate the need to treat between 4.7 to 9.5 million acres (1.9 to 3.8 million ha). Using the area of fireshed planning areas that have at least 25% of their area within the bounds of the priority landscapes and are in a high-risk fireshed as the treatment area objective (20-40%). # Area of pa&#39;s by level of constraint constrained_by_scnro_ls_cnstrnt_temp &lt;- constrained_by_scnro_ls_pa |&gt; dplyr::filter(fireshed_crisis_strategy %in% c(&quot;USFS-Only&quot;, &quot;All-Lands&quot;)) |&gt; dplyr::group_by(scenario_id,scenario_lab,state,name,area_name,cnstrnt_class) |&gt; dplyr::summarise( n = n() , dplyr::across( c(feature_area_ha,covertype_area_ha,rmn5_administrative_area_ha) , ~ sum(.x,na.rm = T) ) ) |&gt; dplyr::group_by(scenario_id,scenario_lab,state,name,area_name) |&gt; dplyr::mutate( # cnstrnt_class = stringr::word(cnstrnt_class) |&gt; stringr::str_remove_all(&quot;\\\\.&quot;) total_area_ha = sum(feature_area_ha) , total_covertype_area_ha = sum(covertype_area_ha) # &quot;the need to treat 20 to 40 percent of the overall fireshed&quot; , pct_treatable = rmn5_administrative_area_ha/total_area_ha , objective_lo_treat_area_ha = total_area_ha*.2 , objective_hi_treat_area_ha = total_area_ha*.4 ) |&gt; dplyr::ungroup() |&gt; dplyr::arrange(state,name,scenario_id,cnstrnt_class) 6.7.1 Objective vs. Treatable Table table_temp &lt;- constrained_by_scnro_ls_cnstrnt_temp |&gt; dplyr::mutate( cnstrnt_class = stringr::word(cnstrnt_class) |&gt; stringr::str_remove_all(&quot;\\\\.&quot;) ) |&gt; dplyr::rename( remaining_pct=pct_treatable , remaining_ha=rmn5_administrative_area_ha ) |&gt; dplyr::select(-c(feature_area_ha, covertype_area_ha)) |&gt; tidyr::pivot_wider( names_from = cnstrnt_class , values_from = c(n, remaining_pct, remaining_ha) , names_glue = &quot;{cnstrnt_class}_{.value}&quot; , values_fill = 0 ) |&gt; dplyr::mutate( tot_remaining_ha = low_remaining_ha+med_remaining_ha ,tot_remaining_pct = low_remaining_pct+med_remaining_pct ) |&gt; dplyr::relocate(tot_remaining_ha,.after = med_remaining_ha) |&gt; dplyr::inner_join( wf_landscapes |&gt; sf::st_drop_geometry() |&gt; dplyr::select(area_name,hectares) |&gt; dplyr::rename(landscape_area_ha=hectares) , by = dplyr::join_by(area_name) ) # make table kableExtra::kable( table_temp |&gt; dplyr::select( c( scenario_lab , landscape_area_ha , total_area_ha , total_covertype_area_ha # light and mod area , low_remaining_ha, med_remaining_ha, tot_remaining_ha , low_remaining_pct, med_remaining_pct, tot_remaining_pct ) ) |&gt; dplyr::mutate( dplyr::across( tidyselect::ends_with(&quot;_ha&quot;) , ~ scales::comma(.x, suffix = &quot;k&quot;, scale = 1e-3, accuracy = 1) ) , dplyr::across( tidyselect::ends_with(&quot;_pct&quot;) , ~ scales::percent(.x, accuracy = .1) ) ) , caption = &quot;Wildfire Crisis Strategy High-Risk Fireshed Planning Areas&lt;br&gt;mechanically available for treatment in lightly and moderately constrained planning areas (&gt;25% in landscape)&quot; , col.names = c( &quot;&quot; , &quot;Total\\nLandscape&quot; , &quot;High-risk\\nFireshed PAs&quot; , &quot;High-risk\\nForest+Shrub&quot; , &quot;Lightly Constrained&quot;, &quot;Moderately Constrained&quot; , &quot;Total&quot; , &quot;Lightly Constrained&quot;, &quot;Moderately Constrained&quot; , &quot;Total&quot; ) , escape = F ) |&gt; add_header_above(c(&quot; &quot; = 1, &quot;Area (ha)&quot; = 3, &quot;Treatable High-Risk Area (ha)&quot;=3, &quot;Percent of High-Risk Area&quot; = 3)) |&gt; kable_classic(full_width=T) |&gt; pack_rows(index = table(forcats::fct_inorder(table_temp$area_name))) |&gt; kableExtra::kable_styling(font_size = 11,fixed_thead = TRUE) |&gt; kableExtra::column_spec( 10 , color = &quot;white&quot; , background = table_temp |&gt; dplyr::mutate( is_gt20 = dplyr::case_when( low_remaining_pct &gt;= .2 ~ &quot;#008b8b&quot; , tot_remaining_pct &gt;= .2 ~ &quot;#545454&quot; , TRUE ~ &quot;#cd3700&quot; ) ) |&gt; dplyr::pull(is_gt20) ) |&gt; kableExtra::scroll_box(width = &quot;740px&quot;) Table 6.3: Wildfire Crisis Strategy High-Risk Fireshed Planning Areasmechanically available for treatment in lightly and moderately constrained planning areas (&gt;25% in landscape) Area (ha) Treatable High-Risk Area (ha) Percent of High-Risk Area Total Landscape High-risk Fireshed PAs High-risk Forest+Shrub Lightly Constrained Moderately Constrained Total Lightly Constrained Moderately Constrained Total AZ: 4FRI Scenario 1 2,418k 1,579k 1,436k 344k 90k 434k 21.8% 5.7% 27.5% Scenario 2 2,418k 1,579k 1,436k 549k 56k 606k 34.8% 3.6% 38.3% Scenario 3 2,418k 1,579k 1,436k 917k 33k 950k 58.1% 2.1% 60.2% AZ: Prescott Scenario 1 254k 221k 191k 30k 17k 47k 13.6% 7.8% 21.4% Scenario 2 254k 221k 191k 64k 15k 78k 28.8% 6.6% 35.4% Scenario 3 254k 221k 191k 97k 10k 107k 43.9% 4.5% 48.4% AZ: San Carlos Apache Tribal Forest Protection Scenario 1 1,156k 250k 230k 4k 20k 24k 1.4% 8.1% 9.6% Scenario 2 1,156k 250k 230k 32k 41k 73k 12.7% 16.3% 29.0% Scenario 3 1,156k 250k 230k 64k 28k 92k 25.4% 11.2% 36.6% CA: North Yuba Scenario 1 144k 206k 197k 19k 32k 51k 9.5% 15.4% 24.9% Scenario 2 144k 206k 197k 68k 15k 82k 33.0% 7.1% 40.1% Scenario 3 144k 206k 197k 91k 10k 101k 44.3% 4.8% 49.0% CA: Plumas Community Protection Scenario 1 108k 157k 148k 15k 28k 43k 9.4% 17.9% 27.3% Scenario 2 108k 157k 148k 64k 4k 68k 40.7% 2.6% 43.3% Scenario 3 108k 157k 148k 82k 3k 85k 52.4% 1.7% 54.1% CA: Southern California Fireshed Risk Reduction Strategy Scenario 1 1,637k 1,053k 854k 18k 87k 105k 1.7% 8.2% 10.0% Scenario 2 1,637k 1,053k 854k 149k 75k 224k 14.2% 7.1% 21.3% Scenario 3 1,637k 1,053k 854k 224k 56k 280k 21.3% 5.3% 26.6% CA: Stanislaus Scenario 1 123k 153k 143k 25k 22k 48k 16.5% 14.5% 31.1% Scenario 2 123k 153k 143k 61k 6k 66k 39.7% 3.7% 43.3% Scenario 3 123k 153k 143k 80k 0k 80k 52.1% 0.0% 52.1% CA: Trinity Forest Health and Fire-Resilient Rural Communities Scenario 1 368k 394k 336k 0k 24k 24k 0.0% 6.0% 6.0% Scenario 2 368k 394k 336k 26k 33k 59k 6.6% 8.3% 14.9% Scenario 3 368k 394k 336k 103k 33k 136k 26.1% 8.5% 34.5% CO: Colorado Front Range Scenario 1 1,449k 1,138k 823k 88k 109k 197k 7.7% 9.6% 17.3% Scenario 2 1,449k 1,138k 823k 278k 52k 330k 24.4% 4.6% 29.0% Scenario 3 1,449k 1,138k 823k 348k 58k 406k 30.6% 5.1% 35.7% ID: Nez Perce-Clearwater-Lower Salmon Scenario 1 787k 520k 444k 69k 43k 112k 13.2% 8.3% 21.4% Scenario 2 787k 520k 444k 179k 14k 194k 34.5% 2.8% 37.2% Scenario 3 787k 520k 444k 187k 12k 199k 36.0% 2.3% 38.2% ID: Southwest Idaho Scenario 1 694k 734k 632k 201k 35k 236k 27.4% 4.7% 32.1% Scenario 2 694k 734k 632k 366k 19k 386k 49.9% 2.6% 52.5% Scenario 3 694k 734k 632k 382k 13k 396k 52.1% 1.8% 53.9% MT: Kootenai Complex Scenario 1 407k 322k 294k 92k 13k 105k 28.5% 4.0% 32.5% Scenario 2 407k 322k 294k 136k 5k 141k 42.3% 1.7% 43.9% Scenario 3 407k 322k 294k 181k 9k 190k 56.4% 2.8% 59.2% NV: Sierra and Elko Fronts Scenario 1 1,372k 678k 453k 111k 40k 151k 16.4% 5.9% 22.2% Scenario 2 1,372k 678k 453k 222k 18k 240k 32.7% 2.6% 35.3% Scenario 3 1,372k 678k 453k 248k 12k 260k 36.6% 1.8% 38.4% NM: Enchanted Circle Scenario 1 592k 318k 285k 38k 32k 70k 12.1% 10.0% 22.1% Scenario 2 592k 318k 285k 112k 15k 126k 35.1% 4.6% 39.6% Scenario 3 592k 318k 285k 125k 12k 138k 39.4% 3.8% 43.2% OR: Central Oregon Scenario 1 1,056k 278k 232k 145k 5k 150k 51.9% 1.8% 53.7% Scenario 2 1,056k 278k 232k 168k 2k 170k 60.4% 0.6% 61.0% Scenario 3 1,056k 278k 232k 202k 0k 202k 72.7% 0.0% 72.7% OR: Klamath River Basin Scenario 1 3,735k 971k 808k 16k 54k 70k 1.7% 5.6% 7.2% Scenario 2 3,735k 971k 808k 137k 59k 196k 14.1% 6.1% 20.1% Scenario 3 3,735k 971k 808k 230k 68k 298k 23.6% 7.0% 30.7% OR: Mount Hood Forest Health and Fire-Resilient Communities Scenario 1 436k 339k 244k 15k 27k 42k 4.4% 8.0% 12.4% Scenario 2 436k 339k 244k 47k 19k 66k 13.9% 5.6% 19.6% Scenario 3 436k 339k 244k 126k 11k 137k 37.2% 3.1% 40.3% UT: Pine Valley Scenario 1 163k 187k 173k 14k 23k 38k 7.8% 12.4% 20.2% Scenario 2 163k 187k 173k 49k 15k 64k 26.2% 7.9% 34.1% Scenario 3 163k 187k 173k 56k 12k 68k 29.7% 6.6% 36.3% UT: Wasatch Scenario 1 426k 156k 126k 21k 10k 31k 13.5% 6.5% 20.0% Scenario 2 426k 156k 126k 43k 6k 50k 27.9% 4.1% 31.9% Scenario 3 426k 156k 126k 46k 7k 53k 29.6% 4.3% 33.9% WA: Central Washington Initiative Scenario 1 985k 818k 588k 14k 27k 42k 1.8% 3.3% 5.1% Scenario 2 985k 818k 588k 58k 43k 101k 7.0% 5.3% 12.3% Scenario 3 985k 818k 588k 204k 45k 249k 24.9% 5.5% 30.4% WA: Colville Northeast Washington Vision Scenario 1 707k 272k 244k 52k 25k 77k 19.3% 9.2% 28.5% Scenario 2 707k 272k 244k 116k 7k 123k 42.7% 2.6% 45.3% Scenario 3 707k 272k 244k 142k 5k 147k 52.0% 2.0% 54.0% 6.7.2 Reduction in treatable area flow table_temp |&gt; dplyr::filter(scenario_id==1) |&gt; dplyr::select( c( area_name , landscape_area_ha , total_area_ha , total_covertype_area_ha # , tot_remaining_ha # , low_remaining_ha ) ) |&gt; tidyr::pivot_longer( !area_name , names_to = &quot;name&quot; , values_to = &quot;hectares&quot; ) |&gt; dplyr::group_by(area_name) |&gt; dplyr::mutate(order = dplyr::row_number(),y_val=2) |&gt; dplyr::ungroup() |&gt; dplyr::cross_join(data.frame(scenario_id = 1:3)) |&gt; #### dplyr::bind_rows( table_temp |&gt; dplyr::select( c( area_name , scenario_id , tot_remaining_ha , low_remaining_ha ) ) |&gt; tidyr::pivot_longer( !c(area_name,scenario_id) , names_to = &quot;name&quot; , values_to = &quot;hectares&quot; ) |&gt; dplyr::group_by(area_name,scenario_id) |&gt; dplyr::mutate( order = dplyr::row_number()+3 , y_val = scenario_id ) |&gt; dplyr::ungroup() |&gt; dplyr::relocate(scenario_id,.after = dplyr::last_col()) ) |&gt; dplyr::arrange(area_name,order,y_val ) |&gt; dplyr::mutate( order_lab = factor( order , levels = 1:5 , labels = c( &quot;Total\\nLandscape&quot; , &quot;High-risk\\nFireshed PAs&quot; , &quot;High-risk\\nForest+Shrub&quot; , &quot;Lt.+Md. Constrained&quot; , &quot;Lightly Constrained&quot; ) , ordered = T ) ) |&gt; dplyr::inner_join( wf_landscapes |&gt; sf::st_drop_geometry() |&gt; dplyr::select(area_name, hectares) |&gt; dplyr::rename(tot_hectares=hectares) , by = dplyr::join_by(area_name) ) |&gt; dplyr::inner_join( table_temp |&gt; dplyr::filter(scenario_id==1) |&gt; dplyr::select(area_name, objective_lo_treat_area_ha) , by = dplyr::join_by(area_name) ) |&gt; dplyr::mutate( y_val = -y_val , sizing = ifelse(hectares&gt;tot_hectares,1,hectares/tot_hectares) , coloring = dplyr::case_when( order %in% 4:5 &amp; hectares &gt;= objective_lo_treat_area_ha ~ 1 , order %in% 4:5 &amp; hectares &lt; objective_lo_treat_area_ha ~ 2 , T ~ 3 ) ) |&gt; # dplyr::filter(stringr::str_starts(area_name,&quot;CA&quot;)) |&gt; # View() ggplot() + geom_line( mapping = aes(x = order_lab, y = y_val, group = scenario_id) , color = &quot;gray&quot; ) + geom_point( mapping = aes(x = order_lab, y = y_val, size = sizing*100, color = factor(coloring)) , shape = 15 ) + geom_text( mapping = aes( x = order_lab, y = y_val, group = scenario_id , label = scales::comma(hectares,suffix = &quot;k&quot;, scale = 1e-3, accuracy = 1) ) , size = 2.5 , color = &quot;black&quot; , vjust = 2.5 , angle = 90 ) + geom_text( mapping = aes( x = order_lab, y = y_val, group = scenario_id , label = ifelse( order == 4, paste0(&quot;Scenario&quot;, y_val*-1), NA ) , fontface = &quot;italic&quot; ) , size = 2.5 , color = &quot;black&quot; , hjust = 0.1 , vjust = -1.4 ) + facet_wrap(facets = vars(area_name) , ncol = 3 , labeller = label_wrap_gen(width = 35, multi_line = TRUE) , scales = &quot;free_x&quot; ) + scale_color_manual(values = c(&quot;#008b8b&quot;, &quot;#cd3700&quot;, &quot;#bebebe&quot;)) + scale_y_continuous(expand = expansion(c(0.3,0.3))) + scale_x_discrete(labels = scales::label_wrap(10)) + labs( x = &quot;&quot; , y = &quot;&quot; , subtitle = &quot;&lt;span&gt;&lt;span style=&#39;color:#008b8b;&#39;&gt;&lt;b&gt;&lt;i&gt;≥20% treatable&lt;/i&gt;&lt;/b&gt;&lt;/span&gt; | &lt;span style=&#39;color:#cd3700;&#39;&gt;&lt;b&gt;&lt;i&gt;&lt;20% treatable&lt;/i&gt;&lt;/b&gt;&lt;/span&gt;&lt;/span&gt;&quot; ) + theme_light() + theme( legend.position = &quot;none&quot; , legend.direction = &quot;horizontal&quot; , legend.title = element_text(size=7) , axis.title = element_text(size=9) , axis.text.y = element_blank() , axis.ticks.y = element_blank() , axis.text = element_text(size = 7) , panel.grid = element_blank() , plot.subtitle = ggtext::element_markdown(size = 10) ) 6.7.3 Objective vs. Treatable Plot # plot ggplot( data = constrained_by_scnro_ls_cnstrnt_temp |&gt; dplyr::filter(cnstrnt_class!=&quot;high constraint&quot;) |&gt; dplyr::mutate(cnstrnt_class=forcats::fct_rev(cnstrnt_class)) , mapping = aes( x = pct_treatable , y = scenario_lab ) ) + geom_vline(xintercept = 0.2 , color = &quot;gray88&quot; , alpha = 0.6 ) + geom_vline(xintercept = 0.4 , color = &quot;gray88&quot; , alpha = 0.6 ) + geom_rect(mapping = aes(xmin = 0.2, xmax=0.4, ymin = -Inf, ymax = Inf) , fill = &quot;gray88&quot; , alpha = 0.6 ) + geom_col( mapping = aes(fill = cnstrnt_class) , color = NA, width = 0.7 ) + geom_text( mapping = aes( group = cnstrnt_class , label = scales::percent( ifelse(pct_treatable&lt;.06,NA,pct_treatable) , accuracy = 1 ) # , fontface = &quot;bold&quot; ) , position = position_stack(vjust = 0.5) , color = &quot;black&quot;, size = 2 ) + # total geom_text( data = constrained_by_scnro_ls_cnstrnt_temp |&gt; dplyr::filter(cnstrnt_class!=&quot;high constraint&quot;) |&gt; dplyr::group_by(area_name, scenario_lab) |&gt; dplyr::mutate(low=ifelse(cnstrnt_class==&quot;low constraint&quot;,pct_treatable,0)) |&gt; dplyr::summarise( pct_treatable = sum(pct_treatable) , low = sum(low) ) |&gt; dplyr::mutate( is_gt20 = dplyr::case_when( low &gt;= .2 ~ &quot;1&quot; , pct_treatable &gt;= .2 ~ &quot;2&quot; , TRUE ~ &quot;3&quot; ) ) , mapping = aes( y = scenario_lab, x = pct_treatable , label = scales::percent(pct_treatable, accuracy = 1) , color = is_gt20 , fontface = &quot;bold&quot; ) , size = 3 , hjust = -0.1 , show.legend = F ) + facet_grid( rows = vars(area_name) , labeller = label_wrap_gen(width = 35, multi_line = TRUE) , switch = &quot;y&quot; ) + scale_fill_manual(values = RColorBrewer::brewer.pal(n=3,name=&quot;RdYlBu&quot;)[2:3]) + scale_color_manual(values = c(&quot;darkcyan&quot;, &quot;gray33&quot;, &quot;orangered3&quot;)) + scale_x_continuous(expand = expansion(mult = c(0, .1)),labels = scales::percent_format()) + labs( fill = &quot;Level of\\nConstraint&quot; , y = &quot;&quot; , subtitle = &quot;treatment objective&quot; , x = &quot;Percent of Total High-Risk Area&quot; ) + theme_light() + theme( legend.position = &quot;top&quot; , legend.direction = &quot;horizontal&quot; , plot.subtitle = element_text(size = 8, hjust = 0.37,vjust = -25,face=&quot;bold&quot;,color = &quot;gray70&quot;) , legend.title = element_text(size=7) , axis.title = element_text(size=9) , axis.text.x = element_blank() , axis.text = element_text(size = 7) , panel.grid = element_blank() , strip.text = element_text(size = 8) # color = &quot;black&quot;, face = &quot;bold&quot; , strip.text.y.left = element_text(angle = 0) , strip.placement = &quot;outside&quot; ) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
